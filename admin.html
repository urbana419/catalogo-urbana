<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Urbana Visi√≥n</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #1f2937 0%, #374151 100%); min-height: 100vh; padding: 10px; color: white; }
        .container { max-width: 400px; margin: 0 auto; }
        .header { background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; text-align: center; margin-bottom: 20px; }
        .logo { width: 50px; height: 50px; background: linear-gradient(135deg, #3b82f6, #f97316); border-radius: 50%; margin: 0 auto 10px; }
        h1 { font-size: 20px; margin-bottom: 5px; }
        .subtitle { font-size: 12px; opacity: 0.8; }
        .form-card { background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .form-title { font-size: 16px; font-weight: bold; margin-bottom: 15px; text-align: center; color: #60a5fa; }
        .photo-upload { text-align: center; margin-bottom: 15px; }
        .photo-preview { width: 150px; height: 150px; border: 2px dashed #60a5fa; border-radius: 10px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; background-size: cover; background-position: center; }
        .photo-preview.has-image { border-style: solid; }
        .photo-text { font-size: 12px; color: #60a5fa; text-align: center; }
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; font-size: 12px; color: #d1d5db; margin-bottom: 5px; }
        .form-input { width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; background: rgba(255,255,255,0.1); color: white; font-size: 14px; }
        .form-input::placeholder { color: rgba(255,255,255,0.5); }
        .form-select { width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; background: rgba(255,255,255,0.1); color: white; font-size: 14px; }
        .form-select option { background: #374151; color: white; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-size: 14px; font-weight: bold; cursor: pointer; }
        .btn-primary { background: #10b981; color: white; }
        .btn-secondary { background: #6b7280; color: white; margin-top: 10px; }
        .btn-export { background: #f59e0b; color: white; margin-top: 10px; }
        .success-message { background: #10b981; color: white; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px; font-size: 14px; display: none; }
        .enlace-result { background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; border-radius: 10px; padding: 15px; margin-top: 15px; display: none; }
        .enlace-result h4 { color: #60a5fa; margin-bottom: 10px; font-size: 14px; }
        .enlace-url { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; font-size: 12px; margin-bottom: 15px; word-break: break-all; font-family: monospace; }
        .mensaje-plantilla { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; font-size: 12px; margin-bottom: 15px; white-space: pre-wrap; }
        .copy-btn { background: #6b7280; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 11px; cursor: pointer; margin: 5px; width: calc(50% - 5px); }
        .monturas-lista { max-height: 300px; overflow-y: auto; }
        .montura-item { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .montura-info { flex: 1; }
        .montura-codigo { font-weight: bold; margin-bottom: 5px; }
        .montura-detalles { font-size: 11px; color: #d1d5db; }
        .montura-actions { display: flex; gap: 5px; }
        .btn-small { padding: 5px 10px; font-size: 11px; border: none; border-radius: 5px; cursor: pointer; text-decoration: none; display: inline-block; }
        .btn-ver { background: #3b82f6; color: white; }
        .btn-eliminar { background: #ef4444; color: white; }
        .export-section { background: rgba(245, 158, 11, 0.1); border: 1px solid #f59e0b; border-radius: 10px; padding: 15px; margin-top: 15px; }
        .export-title { color: #f59e0b; font-weight: bold; margin-bottom: 10px; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo"></div>
            <h1>Panel Admin</h1>
            <p class="subtitle">Urbana Visi√≥n - Gesti√≥n de Monturas</p>
        </div>
        
        <div class="form-card">
            <div class="form-title">üì∑ Subir Nueva Montura</div>
            
            <div id="successMessage" class="success-message">‚úÖ Montura guardada</div>
            
            <div class="photo-upload">
                <div class="photo-preview" id="photoPreview" onclick="document.getElementById('photoInput').click()">
                    <div class="photo-text">üì∑<br>Tomar Foto<br><small>Toca aqu√≠</small></div>
                </div>
                <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;">
            </div>
            
            <div class="form-group">
                <label class="form-label">C√≥digo de Montura</label>
                <input type="text" class="form-input" id="codigo" placeholder="Ej: H001" maxlength="4">
            </div>
            
            <div class="form-group">
                <label class="form-label">Categor√≠a</label>
                <select class="form-select" id="categoria">
                    <option value="">Seleccionar categor√≠a</option>
                    <option value="hombre">üë® Hombres</option>
                    <option value="mujer">üë© Mujeres</option>
                    <option value="deportivo">üèÉ Deportivos</option>
                    <option value="ni√±os">üë∂ Ni√±os</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">Precio</label>
                <input type="text" class="form-input" id="precio" placeholder="Ej: $2,500" maxlength="10">
            </div>
            
            <div class="form-group">
                <label class="form-label">Nombre (Opcional)</label>
                <input type="text" class="form-input" id="nombre" placeholder="Ej: Elegante Negro" maxlength="30">
            </div>
            
            <button class="btn btn-primary" onclick="guardarEnCatalogo()">üíæ Guardar en Cat√°logo</button>
            <button class="btn btn-secondary" onclick="verCatalogo()">üëÅÔ∏è Ver Cat√°logo</button>
            
            <div id="enlaceResult" class="enlace-result">
                <h4>üîó Listo para enviar:</h4>
                <strong>üì± Enlace:</strong>
                <div id="enlaceCatalogo" class="enlace-url"></div>
                <strong>üìã Mensaje:</strong>
                <div id="mensajePlantilla" class="mensaje-plantilla"></div>
                <div style="display: flex; gap: 10px;">
                    <button class="copy-btn" onclick="copiarEnlace()">üìã Copiar Enlace</button>
                    <button class="copy-btn" onclick="copiarMensaje()">üìã Copiar Mensaje</button>
                </div>
            </div>
        </div>

        <div class="export-section">
            <div class="export-title">üîÑ Sincronizar con otros dispositivos</div>
            <button class="btn btn-export" onclick="exportarDatos()">üì§ Exportar Datos</button>
            <button class="btn btn-export" onclick="document.getElementById('importFile').click()">üì• Importar Datos</button>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importarDatos(event)">
        </div>
        
        <div class="form-card">
            <div class="form-title">üìã Monturas Guardadas</div>
            <div id="monturasGuardadas" class="monturas-lista">
                <div style="text-align: center; color: #6b7280; padding: 20px;">No hay monturas guardadas</div>
            </div>
        </div>
    </div>

    <script>
        let selectedPhoto = null;
        let currentMessage = '';
        let currentLink = '';
        
        document.addEventListener('DOMContentLoaded', function() {
            mostrarMonturasGuardadas();
        });
        
        document.getElementById('photoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    selectedPhoto = e.target.result;
                    const preview = document.getElementById('photoPreview');
                    preview.style.backgroundImage = `url(${selectedPhoto})`;
                    preview.classList.add('has-image');
                    preview.innerHTML = '<div class="photo-text" style="background: rgba(0,0,0,0.7); padding: 5px; border-radius: 5px; color: white;">‚úÖ Foto Lista</div>';
                };
                reader.readAsDataURL(file);
            }
        });
        
        function guardarEnCatalogo() {
            const codigo = document.getElementById('codigo').value.trim().toUpperCase();
            const categoria = document.getElementById('categoria').value;
            const precio = document.getElementById('precio').value.trim();
            const nombre = document.getElementById('nombre').value.trim();
            
            if (!selectedPhoto) { alert('Toma una foto'); return; }
            if (!codigo) { alert('Ingresa el c√≥digo'); return; }
            if (!categoria) { alert('Selecciona categor√≠a'); return; }
            if (!precio) { alert('Ingresa el precio'); return; }
            
            const monturas = JSON.parse(localStorage.getItem('monturas') || '{}');
            monturas[codigo] = {
                codigo: codigo,
                categoria: categoria,
                precio: precio,
                nombre: nombre || 'Sin nombre',
                foto: selectedPhoto,
                fechaCreacion: new Date().toISOString()
            };
            localStorage.setItem('monturas', JSON.stringify(monturas));
            
            const baseUrl = window.location.origin + window.location.pathname.replace('admin.html', 'index.html');
            const enlaceCatalogo = `${baseUrl}?codigo=${codigo}`;
            currentLink = enlaceCatalogo;
            
            document.getElementById('enlaceCatalogo').textContent = enlaceCatalogo;
            
            const nombreCategoria = {
                'hombre': 'üë® Hombres',
                'mujer': 'üë© Mujeres', 
                'deportivo': 'üèÉ Deportivos',
                'ni√±os': 'üë∂ Ni√±os'
            }[categoria];
            
            const mensaje = `ü•Ω NUEVA MONTURA - Urbana Visi√≥n

üìã C√≥digo: ${codigo}
üë§ Categor√≠a: ${nombreCategoria}
üí∞ Precio: ${precio}
${nombre ? `üìù Nombre: ${nombre}` : ''}

üì± VER FOTO:
${enlaceCatalogo}

üè• Urbana Visi√≥n
üì± 809-713-5307
üéÅ 6 meses garant√≠a`;
            
            currentMessage = mensaje;
            document.getElementById('mensajePlantilla').textContent = mensaje;
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('enlaceResult').style.display = 'block';
            
            mostrarMonturasGuardadas();
            limpiarFormulario();
            
            setTimeout(() => document.getElementById('successMessage').style.display = 'none', 3000);
        }

        function exportarDatos() {
            const monturas = localStorage.getItem('monturas') || '{}';
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(monturas);
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "urbana-vision-catalogo.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            alert('üì§ Datos exportados. Guarda el archivo para importar en otro dispositivo.');
        }

        function importarDatos(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        localStorage.setItem('monturas', JSON.stringify(importedData));
                        mostrarMonturasGuardadas();
                        alert('üì• Datos importados correctamente');
                    } catch (error) {
                        alert('‚ùå Error importando datos');
                    }
                };
                reader.readAsText(file);
            }
        }

        function copiarEnlace() {
            navigator.clipboard.writeText(currentLink).then(() => alert('üìã Enlace copiado')).catch(() => alert('Copia manualmente'));
        }

        function copiarMensaje() {
            navigator.clipboard.writeText(currentMessage).then(() => alert('üìã Mensaje copiado')).catch(() => alert('Copia manualmente'));
        }
        
        function limpiarFormulario() {
            document.getElementById('codigo').value = '';
            document.getElementById('categoria').value = '';
            document.getElementById('precio').value = '';
            document.getElementById('nombre').value = '';
            selectedPhoto = null;
            const preview = document.getElementById('photoPreview');
            preview.style.backgroundImage = 'none';
            preview.classList.remove('has-image');
            preview.innerHTML = '<div class="photo-text">üì∑<br>Tomar Foto<br><small>Toca aqu√≠</small></div>';
        }

        function eliminarMontura(codigo) {
            if (confirm(`¬øEliminar ${codigo}?`)) {
                const monturas = JSON.parse(localStorage.getItem('monturas') || '{}');
                delete monturas[codigo];
                localStorage.setItem('monturas', JSON.stringify(monturas));
                mostrarMonturasGuardadas();
                alert(`‚úÖ ${codigo} eliminada`);
            }
        }
        
        function mostrarMonturasGuardadas() {
            const container = document.getElementById('monturasGuardadas');
            const monturas = JSON.parse(localStorage.getItem('monturas') || '{}');
            if (Object.keys(monturas).length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 20px;">No hay monturas guardadas</div>';
                return;
            }
            let html = '';
            for (const codigo in monturas) {
                const montura = monturas[codigo];
                if (!montura) continue;
                const nombreCategoria = {
                    'hombre': 'üë®', 'mujer': 'üë©', 'deportivo': 'üèÉ', 'ni√±os': 'üë∂'
                }[montura.categoria] || 'üëì';
                const baseUrl = window.location.origin + window.location.pathname.replace('admin.html', 'index.html');
                const enlaceMontura = `${baseUrl}?codigo=${codigo}`;
                html += `<div class="montura-item"><div class="montura-info"><div class="montura-codigo">${nombreCategoria} ${codigo} - ${montura.precio}</div><div class="montura-detalles">${montura.nombre}</div></div><div class="montura-actions"><a href="${enlaceMontura}" target="_blank" class="btn-small btn-ver">Ver</a><button onclick="eliminarMontura('${codigo}')" class="btn-small btn-eliminar">Eliminar</button></div></div>`;
            }
            container.innerHTML = html;
        }
        
        function verCatalogo() { window.location.href = 'index.html'; }
    </script>
</body>
</html>
